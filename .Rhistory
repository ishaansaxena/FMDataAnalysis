outline = T,  order="hclust",
addCoef.col = "black", number.digits = 1, number.cex = 3,
cl.pos = 'b', cl.cex = 3, addrect = 3, rect.lwd = 3,)
png(file="corr.png", res=300, width=4500, height=4500)
corrplot(M, tl.cex = 3, tl.col = "black", method = "color",
outline = T,  order="hclust",
addCoef.col = "black", number.digits = 1, number.cex = 3,
cl.pos = 'b', cl.cex = 3, addrect = 3, rect.lwd = 3,)
png(file="corr.png", res=300, width=4500, height=4500)
corrplot(M, tl.cex = 3, tl.col = "black", method = "color",
outline = T,  order="hclust",
addCoef.col = "black", number.digits = 1, number.cex = 3,
cl.pos = 'b', cl.cex = 3, addrect = 3, rect.lwd = 3,)
corrplot(M, tl.cex = 3, tl.col = "black", method = "color",
outline = T,  order="hclust",
addCoef.col = "black", number.digits = 1, number.cex = 3,
cl.pos = 'b', cl.cex = 3, addrect = 3, rect.lwd = 3)
corrplot(M, method = "color", outline = T,  order="hclust")
png(file="corr.png", res=300, width=4500, height=4500)
corrplot(M, method = "color", outline = T,  order="hclust")
corrplot(M, method = "color", outline = T,  order="hclust")
corrplot(M, method="number")
corrplot(M, method = "color", outline = T,  order="hclust")
data <- abilities[, 3:13]
M <- cor(data)
p.mat <- cor.mtest(data)
corrplot(M, method="number")
data <- abilities[, 3:4]
M <- cor(data)
p.mat <- cor.mtest(data)
corrplot(M, method="number")
corrplot(M, method = "color", outline = T,  order="hclust")
abilities[abilities$UID==7458500]
abilities[abilities$UID==7458500, ]
abilities[abilities$UID==7458500, ]
messi <- 7458500
abilities[abilities$UID==messi, ]
abilities[abilities$UID==messi & abilities$Finishing == 20, ]
abilities[which(UID == messi), ]
abilities[which(abilities$UID == messi), ]
abilities[, order(-abilities[which(abilities$UID == messi), ])]
abilities[, order(-abilities[which(abilities$UID == messi), ])]
abilities[which(abilities$UID == messi), ]
names(abilities)
names(abilities)[which(abilities == 20, arr.ind = T)[, "col"]]
names(abilities)[which(abilities == 20, arr.ind = T)[abilities$UID == messi, "col"]]
names(abilities)[which(abilities == 20, arr.ind = T)[abilities$UID == messi, "col"]]
names(abilities)[which(abilities == 20, arr.ind = T)[, "col"]]
abilities[which(abilities$UID == messi), ]
names(abilities)[which(abilities == 20, arr.ind = T)[, "col"]]
df <- abilities[which(abilities$UID == messi), ]
df <- abilities[which(abilities$UID == messi), ]
names(df)[which(df == 20, arr.ind = T)[, "col"]]
df <- abilities[which(abilities$UID == messi), ]
names(df)[which(df == 20, arr.ind = T)[, "col"]]
df <- abilities[which(abilities$UID == messi), ]
cols <- names(df)[which(df == 20, arr.ind = T)[, "col"]]
df <- abilities[which(abilities$UID == messi), ]
cols <- names(df)[which(df >= 19, arr.ind = T)[, "col"]]
cols
df <- abilities[which(abilities$UID == messi), ]
cols <- names(df)[which(df >= 15 & df <= 20, arr.ind = T)[, "col"]]
cols
df <- abilities[which(abilities$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= 15 & df <= 20, arr.ind = T)[, "col"]]
cols
messi <- 7458500
df <- abilities[which(abilities$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= 15 & df <= 20, arr.ind = T)[, "col"]]
cols
df <- abilities[which(abilities$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= 15 & df <= 20, arr.ind = T)[, "col"]]
cols
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
cols <- names(df)[which(df >= 15 & df <= 20, arr.ind = T)[, "col"]]
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
row.names(df)[df$cols[0] > 500]
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
row.names(df)[df$cols[0] > 500]
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
row.names(df)[df$cols[0] >= 15]
df[df$cols[1] >= 15, ]
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
df[df$cols[1] >= 15, ]
df[, df$cols[1] >= 15]
abilities[, abilities$cols[1] >= 15]
abilities[abilities$cols[1] >= 15, ]
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
abilities[abilities$cols[1] >= 15, ]
row.names(abilities)[abilities$cols[1] >= 15]
cols[1]
abilities$cols[1]
abilities$"Flair"
abilities["Flair"]
abilities[cols[1]]
row.names(abilities)[abilities[cols[1]] >= 15]
abilities[abilities[cols[1]] >= 15]
abilities[which(abilities[cols[1]] >= 15)]
abilities[which(abilities[cols[1]] >= 15), ]
length(abilities[which(abilities[cols[1]] >= 15), ])
df <- abilities[which(abilities[cols[1]] >= 15), ]
View(df)
View(df)
low = 15
high = 20
df <- abilities[which(abilities$Name == "Lionel Messi"), ]
df <- abilities[which(abilities$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
data <- abilties
data <- abilities
df <- data[which(data$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
column <- data[cols[1]]
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
df <- data[which(data[cols[1]] >= low & data[cols[1]] <= high), ]
head(df)
getAbilitiesInRange <- function(uid, low, high) {
df <- data[which(data$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$Name == "Lionel Messi"), ]
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange(abilities, 7458500, 15, 20)
cols <- getAbilitiesInRange(abilities, 7458500, 15, 20)
getAbilitiesInRange(abilities, 7458500, 15, 20)
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$uid == uid), ]
printf("Player Name: %s\n", )
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$uid == uid), ]
printf("Player Name: %s\n", df$Name)
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange(abilities, 7458500, 15, 20)
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$uid == uid), ]
print(paste0("Player Name: ", df$Name))
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange(abilities, 7458500, 15, 20)
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$uid == uid), ]
#print(paste0("Player Name: ", df$Name))
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange(abilities, 7458500, 15, 20)
df <- data[which(data$uid == uid), ]
uid <- 7458500
df <- data[which(data$uid == uid), ]
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
df <- data[which(data$UID == uid), ]
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$UID == uid), ]
print(paste0("Player Name: ", df$Name))
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
data <- abilities
getAbilitiesInRange <- function(data, uid, low, high) {
df <- data[which(data$UID == uid), ]
print(paste0("Player Name: ", df$Name))
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
getAbilitiesInRange(abilities, uid, low, high)
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
df <- data
df <- data[which(data[cols[1]] >= low & data[cols[1]] <= high), ]
View(df)
length(cols)
for (i in 1:length(cols)) {
print(cols[i])
}
cols <- getAbilitiesInRange(abilities, uid, low, high)
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
df <- data
df <- data[which(data[cols[1]] >= low & data[cols[1]] <= high), ]
for (i in 1:length(cols)) {
print(cols[i])
}
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
df <- data
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low & df[cols[i]] <= high), ]
}
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
df <- data
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low & df[cols[i]] <= high), ]
}
df
cols <- c("Flair", "OffTheBall", "FirstTouch", "Finishing")
getPlayersByAbilities <- function(data, cols, low, high) {
df <- data
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low & df[cols[i]] <= high), ]
}
df
}
df <- getPlayersByAbilities(cols)
df <- getPlayersByAbilities(abilities, cols, low, high)
getPlayersByAbilitiesInRange <- function(data, cols, low, high) {
df <- data
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low & df[cols[i]] <= high), ]
}
df
}
df <- getPlayersByAbilitiesInRange(abilities, cols, low, high)
df
cols <- getAbilitiesInRange(abilities, uid, low, high)
df <- getPlayersByAbilitiesInRange(abilities, cols, low, high)
abs = 20
range = 0.95 * abs
range
range = (1 - 0.95) * abs
range
df <- data[which(data$UID == uid), ]
df
df <- data[which(data$UID == uid), 3:64]
range = (1 - 0.95) * abs
df <- data[which(data$UID == uid), 3:64]
getAbilitiesInRange <- function(uid, low, high) {
data <- abilities
df <- data[which(data$UID == uid), ]
print(paste0("Player Name: ", df$Name))
cols <- names(df)[which(df >= low & df <= high, arr.ind = T)[, "col"]]
cols
}
cols <- getAbilitiesInRange(uid, low, high)
getPlayersByAbilitiesInRange <- function(cols, low, high) {
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low & df[cols[i]] <= high), ]
}
df
}
df <- getPlayersByAbilitiesInRange(abilities, cols, low, high)
df <- getPlayersByAbilitiesInRange(cols, low, high)
getSimilarPlayer <- function(uid, coeff) {
abs = 20
range = (1 - coeff) * abs # 0.95 => \pm 0.05*abs
}
abs = 20
range = (1 - 0.95) * abs
df <- data[which(data$UID == uid), 3:64]
df <- data[which(data$UID == uid), 3:64] - 1
abs = 20
range = (1 - 0.95) * abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
View(low)
View(low)
View(high)
View(high)
abs = 20
range = as.integer((1 - 0.95) * abs)
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
abs = 20
range = as.integer((1 - 0.95) * abs)
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
cols
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = (1 - coeff) * abs # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low[i] & df[cols[i]] <= high[i]), ]
}
df
}
getSimilarPlayer(uid, 0)
df <- getSimilarPlayer(uid, 0)
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = (1 - coeff) * abs # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low[i] & df[cols[i]] <= high[i]), ]
}
print(df)
}
df <- getSimilarPlayer(uid, 0)
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = (1 - coeff) * abs # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low[i] & df[cols[i]] <= high[i]), ]
}
print(df)
}
df <- getSimilarPlayer(uid, 1)
data <- abilities
abs = 20
range = (1 - coeff) * abs # 0.95 => \pm 0.05*abs
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
coeff = 0.95
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= low[i] & df[cols[i]] <= high[i]), ]
}
df <- abilities
df <- df[which(df[cols[1]] >= low[1] & df[cols[1]] <= high[1]), ]
df[cols[1]]
low[1]
df[cols[1]] >= low[1]
df[which(df[cols[1]] >= low[1])]
df[which(df[cols[1]] >= as.integer(low[1]))]
low[1]
as.integer(low[1])
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
print(df)
}
getSimilarPlayers(uid, 0.95)
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:64]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
df
}
getSimilarPlayers(uid, 0.95)
getSimilarPlayers(uid, 0.9)
getSimilarPlayers(uid, 0.9)[, 1:2]
getSimilarPlayers(uid, 0.8)[, 1:2]
getSimilarPlayers(uid, 0.6)[, 1:2]
getSimilarPlayers(uid, 0.75)[, 1:2]
getSimilarPlayers(uid, 0.7)[, 1:2]
abilites[, 60:60]
abilities[, 60:60]
abilities[60:60, ]
abilities[, 61:62]
abilities[1, 61:62]
abilities[1, 50:62]
abilities[1, 52:62]
abilities[1, 52:52]
abilities[1, 13:51]
abilities[1, 14:51]
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 14:51]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
df
}
getSimilarPlayers(uid, 0.7)[, 1:2]
getSimilarPlayers(uid, 0.8)[, 1:2]
getSimilarPlayers(uid, 0.77)[, 1:2]
getSimilarPlayers(uid, 0.75)[, 1:2]
getSimilarPlayers(uid, 0.72)[, 1:2]
getSimilarPlayers(uid, 0.7)[, 1:2]
abilities[1, 52:52]
abilities[1, 52:53]
abilities[1, 40:53]
abilities[1, 40:45]
abilities[1, c(40:45, 47)]
abilities[1, c(40:45, 47, 48, 50, 51)]
getSimilarPlayers <- function(uid, coeff) {
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), c(14:45, 47, 48, 50, 51)] # Exclude footedness, GK Stats, Hidden Stats
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
df
}
getSimilarPlayers(uid, 0.7)[, 1:2]
View(df)
df <- getSimilarPlayers(uid, 0.7)[, 1:2]
View(df)
View(df)
df <- getSimilarPlayers(uid, 0.7)
getSimilarGoalkeepers <- function(uid, coeff) {
data <- abilities
abs = 20
range = as.integer((1 - coeff) * abs) # 0.95 => \pm 0.05*abs
df <- data[which(data$UID == uid), 3:13]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
df
}
df <- getSimilarPlayers(uid, 0.7)
getSimilarPlayers(uid, 0.7)[, 1:2]
getSimilarGoalkeepers(uidk, 0.7)[, 1:2]
uidk <- 67030171
getSimilarGoalkeepers(uidk, 0.7)[, 1:2]
getSimilarGoalkeepers(uidk, 0.9)[, 1:2]
getSimilarGoalkeepers(uidk, 0.85)[, 1:2]
df <- getSimilarGoalkeepers(uidk, 0.85)
View(df)
View(df)
getSimilarPlayers <- function(uid, range) {
df <- data[which(data$UID == uid), c(14:45, 47, 48, 50, 51)] # Exclude footedness, GK Stats, Hidden Stats
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
df
}
getSimilarPlayers(uid, 5)[, 1:2]
getSimilarPlayers(uid, 6)[, 1:2]
getSimilarGoalkeepers <- function(uid, range) {
df <- data[which(data$UID == uid), 3:13]
low <- df - range
high <- df + range
cols <- names(df)[which(df >= 0 & df <= 20, arr.ind = T)[, "col"]]
df <- abilities
for (i in 1:length(cols)) {
df <- df[which(df[cols[i]] >= as.integer(low[i]) & df[cols[i]] <= as.integer(high[i])), ]
}
df
}
df <- getSimilarGoalkeepers(uidk, 5)
getSimilarGoalkeepers(uidk, 3)[, 1:2]
getSimilarGoalkeepers(uidk, 2)[, 1:2]
getSimilarGoalkeepers(uidk, 3)[, 1:2]
getSimilarPlayers(7458272, 6)[, 1:2]
getSimilarPlayers(7458272, 4)[, 1:2]
getSimilarPlayers(7458272, 5)[, 1:2]
getSimilarPlayers(7458272, 6)[, 1:2]
View(dataset)
getSimilarPlayers(55063369, 6)[, 1:2]
getSimilarPlayers(55063369, 4)[, 1:2]
getSimilarPlayers(55063369, 3)[, 1:2]
getSimilarPlayers(55063369, 4)[, 1:2]
getSimilarPlayers(43124203, 4)[, 1:2]
getSimilarPlayers(43124203, 3)[, 1:2]
View(abilities)
View(abilities)

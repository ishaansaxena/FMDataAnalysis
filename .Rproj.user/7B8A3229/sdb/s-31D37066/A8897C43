{
    "collab_server" : "",
    "contents" : "library(corrplot)\n\n# Significance test function from http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram\n# mat : is a matrix of data\n# ... : further arguments to pass to the native R cor.test function\ncor.mtest <- function(mat, ...) {\n  mat <- as.matrix(mat)\n  n <- ncol(mat)\n  p.mat<- matrix(NA, n, n)\n  diag(p.mat) <- 0\n  for (i in 1:(n - 1)) {\n    for (j in (i + 1):n) {\n      tmp <- cor.test(mat[, i], mat[, j], ...)\n      p.mat[i, j] <- p.mat[j, i] <- tmp$p.value\n    }\n  }\n  colnames(p.mat) <- rownames(p.mat) <- colnames(mat)\n  p.mat\n}\n\n# Plotting correlation in abilities\n# Choosing data\ndata <- abilities[, c(3:64)]\n\n# Significance values\np.mat <- cor.mtest(data)\n\n# Calculate correlation values\nM <- cor(data)\n\n# Plot graph of ability correlations\npng(file=\"Plots/abilities.png\", res=72, width=6000, height=6000)\ncorrplot(M, method = \"color\", type=\"full\", order=\"hclust\", \n         addCoef.col = \"black\", number.digits = 2,\n         # p.mat = p.mat, sig.level = 0.01, \n         tl.cex = 3, number.cex = 3, cl.pos = 'b', cl.cex = 3, \n         addrect = 10, rect.lwd = 5,\n         diag = TRUE)\ndev.off()\n\n# Plotting corrlation in positional abilities\n# Choosing data\ndata <- positions[, c(3:17)]\n\n# Significance values\np.mat <- cor.mtest(data)\n\n# Calculate correlation values\nM <- cor(data)\n\n# Plot graph of ability correlations\npng(file=\"positions.png\", res=128, width=2000, height=2000)\ncorrplot(M, method = \"color\", type=\"full\", order=\"hclust\", \n         addCoef.col = \"black\", number.digits = 2,\n         p.mat = p.mat, sig.level = 0.01, #insig = \"blank\",\n         #tl.cex = 3, number.cex = 3, cl.pos = 'b', cl.cex = 3, \n         addrect = 10, rect.lwd = 2,\n         diag = TRUE)\ndev.off()\n\n",
    "created" : 1526272492920.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "700600175",
    "id" : "A8897C43",
    "lastKnownWriteTime" : 1526272598,
    "last_content_update" : 1526272598736,
    "path" : "~/Envelope/Work/Data Science/Football Manager/Analysis/correlation.r",
    "project_path" : "Analysis/correlation.r",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}